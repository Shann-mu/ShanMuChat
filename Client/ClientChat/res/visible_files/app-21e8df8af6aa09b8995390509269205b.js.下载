function getFileIcon(){var e="";return e?`<i class="mr-1 iconfont icon-file ${e}"></i>`:'<i class="iconfont icon-file text-black mr-1"></i>'}function generateOneTemp(e,t,r){var i=e;if($.trim(t).length>0){var a=t.toLowerCase(),o=e.toLowerCase().indexOf(a);if(o>=0){var n=e.substring(o,o+t.length);i=e.replace(n,"<strong>"+n+"</strong>")}}return`<a class="tree-item d-flex d-align-center" href="${r+e}" data-path="${e}">\n    ${getFileIcon(e)}\n    ${i}\n  </a>`}function generateFilesTemp(e,t,r){var i="<div class=\"row column tree-holder head-file-temp-list\" id=\"file-temp-list\">\n    <div class='tree-content-holder' style='margin-top:6px;'>\n      <div class='tree-content' style='padding:6px 0;background-color:#fff'>",a="</div></div></div>";if(0==e.length)return i+"<div style='padding: 50px 12px;width:fit-content;margin:auto'>\u627e\u4e0d\u5230\u76f8\u5173\u6587\u4ef6</div>"+a;var o="";r=`${root_url}/blob/${ref}/`;for(var n=0;n<e.length;n++)o+=generateOneTemp(e[n],t,r);return i+o+a}function showFilesData(){toggleSearchButton(),setTimeout(()=>{$projectSearchPanelBox.show()},300),$searchFileName.val("").focus().trigger("keyup")}function toggleSearchButton(){$("#search-files-loading").toggleClass("octicon octicon-list-unordered spinner loading icon")}function getFilesList(){toggleSearchButton(),files_data==undefined?send_request||(send_request=!0,ref=$("#ref").val(),http_remote=gon.http_clone,root_url=http_remote.replace(/\.git$/i,"").replace("https://","//"),url=root_url+"/file_list",ref||(ref="master"),$.ajax({url:url,data:"ref="+ref,type:"GET",success:function(e){send_request=!1,files_data=e,showFilesData()},error:function(){send_request=!1,toggleSearchButton(),Flash.error("\u56e0\u4e3a\u7f51\u7edc\u6216\u5176\u4ed6\u539f\u56e0,\u6587\u4ef6\u5217\u8868\u83b7\u53d6\u5931\u8d25,\u8bf7\u7a0d\u540e\u91cd\u8bd5!")}})):showFilesData()}var MAX_FILES_SIZE=24,files_data=undefined,ref=undefined,root_url=undefined,send_request=!1,$projectSearchPanel=$(".search-box-container"),$projectSearchPanelBox=$(".filter-file-container"),$searchBox=$(".repo-action-list-right").find(".search-input"),$searchFileName=$(".repo-action-list-right").find(".search-file-name"),$projectSearchPanel2=$("#left-head_root_actions .search-box-container"),$projectSearchPanelBox2=$("#left-head_root_actions .filter-file-container"),$searchBox2=$("#left-head_root_actions .repo-action-list-right").find(".search-input"),$searchFileName2=$("#left-head_root_actions .repo-action-list-right").find(".search-file-name");$searchFileName.on("keyup",function(e){if(13==e.which){var t=$(".head-file-temp-list").find(".tree-item");if(1==t.length){var r=$(t[0]).attr("href");window.location.href=r}}else{for(var i=$.trim($(this).val()),a=i.toLowerCase(),o=[],n=0;n<files_data.length;n++){var s=files_data[n].toLowerCase();(!i||-1!=s.indexOf(a))&&o.length<MAX_FILES_SIZE&&o.push(files_data[n])}$(".head-file-temp-list").remove(),$projectSearchPanelBox.append(generateFilesTemp(o,i))}}),$("#git-project-root-actions .head-search-file-btn").on("click",function(){$searchFileName.removeClass("remove-input"),$searchBox.addClass("show"),$searchBox2.removeClass("show"),$(".left-side-container .filter-file-container").addClass("filter-file-container-hide"),getFilesList()}),$(".left-side-container .head-search-file-btn").on("click",function(){$searchFileName2.removeClass("remove-input"),$searchBox2.addClass("show"),$("#git-project-root-actions").find(".repo-action-list-right").find(".search-input").removeClass("show"),$("#git-project-root-actions .filter-file-container").addClass("filter-file-container-hide"),$(".left-side-container .filter-file-container").removeClass("filter-file-container-hide"),getFilesList()}),$(document).on("click",function(e){$searchBox.hasClass("show")&&(e.target==$searchFileName[0]||$searchFileName.has(e.target).length||$projectSearchPanel.has(e.target).length||($searchFileName.addClass("remove-input"),$searchBox.removeClass("show"),$projectSearchPanelBox.hide())),$searchBox2.hasClass("show")||$("#git-project-root-actions .filter-file-container").removeClass("filter-file-container-hide");var t=$("#git-project-root-actions .plus-box");$("#git-project-root-actions #git-tree-file svg")[0]!=e.target&&t.hasClass("click-active")&&(t.removeClass("click-active"),$("#git-project-root-actions .repo-dropdown-box").removeClass("transition visible"))});